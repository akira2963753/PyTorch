"use strict";(self.webpackChunkanytype_publish_renderer=self.webpackChunkanytype_publish_renderer||[]).push([["287"],{23144:function(e,t,r){r.d(t,{Me:()=>l,VY:()=>c,V_:()=>o,Zc:()=>d,a1:()=>p,b2:()=>s,fy:()=>f,sx:()=>u});var i=r(2086),n=r(47895),a=r(75314);function s(e){for(let[t,r]of Object.entries(e))!t.startsWith("$")&&(Array.isArray(r)?r.forEach((r,n)=>{(0,i.xA)(r)&&(r.$container=e,r.$containerProperty=t,r.$containerIndex=n)}):(0,i.xA)(r)&&(r.$container=e,r.$containerProperty=t))}function o(e,t){let r=e;for(;r;){if(t(r))return r;r=r.$container}}function l(e){let t=function(e){for(;e.$container;)e=e.$container;return e}(e).$document;if(!t)throw Error("AST node has no document.");return t}function u(e,t){if(!e)throw Error("Node must be an AstNode.");let r=null==t?void 0:t.range;return new n.i(()=>({keys:Object.keys(e),keyIndex:0,arrayIndex:0}),t=>{for(;t.keyIndex<t.keys.length;){let n=t.keys[t.keyIndex];if(!n.startsWith("$")){let a=e[n];if((0,i.xA)(a)){if(t.keyIndex++,h(a,r))return{done:!1,value:a}}else if(Array.isArray(a)){for(;t.arrayIndex<a.length;){let e=a[t.arrayIndex++];if((0,i.xA)(e)&&h(e,r))return{done:!1,value:e}}t.arrayIndex=0}}t.keyIndex++}return n.Ry})}function c(e,t){if(!e)throw Error("Root node must be an AstNode.");return new n.i8(e,e=>u(e,t))}function d(e,t){if(e){if((null==t?void 0:t.range)&&!h(e,t.range))return new n.i8(e,()=>[])}else throw Error("Root node must be an AstNode.");return new n.i8(e,e=>u(e,t),{includeRoot:!0})}function h(e,t){var r;if(!t)return!0;let i=null===(r=e.$cstNode)||void 0===r?void 0:r.range;return!!i&&(0,a.Z2)(i,t)}function f(e){return new n.i(()=>({keys:Object.keys(e),keyIndex:0,arrayIndex:0}),t=>{for(;t.keyIndex<t.keys.length;){let r=t.keys[t.keyIndex];if(!r.startsWith("$")){let n=e[r];if((0,i.Yk)(n))return t.keyIndex++,{done:!1,value:{reference:n,container:e,property:r}};if(Array.isArray(n)){for(;t.arrayIndex<n.length;){let a=t.arrayIndex++,s=n[a];if((0,i.Yk)(s))return{done:!1,value:{reference:s,container:e,property:r,index:a}}}t.arrayIndex=0}}t.keyIndex++}return n.Ry})}function p(e,t){for(let r of e.getTypeMetaData(t.$type).properties)void 0!==r.defaultValue&&void 0===t[r.name]&&(t[r.name]=function e(t){return Array.isArray(t)?[...t.map(e)]:t}(r.defaultValue))}},85016:function(e,t,r){r.d(t,{MU:()=>s,ne:()=>a});class i{constructor(){this.toDispose=[],this.isDisposed=!1}onDispose(e){this.toDispose.push(e)}dispose(){this.throwIfDisposed(),this.clear(),this.isDisposed=!0,this.toDispose.forEach(e=>e.dispose())}throwIfDisposed(){if(this.isDisposed)throw Error("This cache has already been disposed")}}class n extends i{constructor(){super(...arguments),this.cache=new Map}has(e){return this.throwIfDisposed(),this.cache.has(e)}set(e,t){this.throwIfDisposed(),this.cache.set(e,t)}get(e,t){if(this.throwIfDisposed(),this.cache.has(e))return this.cache.get(e);if(t){let r=t();return this.cache.set(e,r),r}}delete(e){return this.throwIfDisposed(),this.cache.delete(e)}clear(){this.throwIfDisposed(),this.cache.clear()}}class a extends i{constructor(e){super(),this.cache=new Map,this.converter=null!=e?e:e=>e}has(e,t){return this.throwIfDisposed(),this.cacheForContext(e).has(t)}set(e,t,r){this.throwIfDisposed(),this.cacheForContext(e).set(t,r)}get(e,t,r){this.throwIfDisposed();let i=this.cacheForContext(e);if(i.has(t))return i.get(t);if(r){let e=r();return i.set(t,e),e}}delete(e,t){return this.throwIfDisposed(),this.cacheForContext(e).delete(t)}clear(e){if(this.throwIfDisposed(),e){let t=this.converter(e);this.cache.delete(t)}else this.cache.clear()}cacheForContext(e){let t=this.converter(e),r=this.cache.get(t);return r||(r=new Map,this.cache.set(t,r)),r}}class s extends n{constructor(e){super(),this.onDispose(e.workspace.DocumentBuilder.onUpdate(()=>{this.clear()}))}}},30466:function(e,t,r){r.d(t,{AU:()=>i.CancellationTokenSource,Ts:()=>i.CancellationToken});var i=r(13881)},98119:function(e,t,r){r.d(t,{Y:()=>a,k:()=>n});var i=r(47895);class n{constructor(e){if(this.map=new Map,e)for(let[t,r]of e)this.add(t,r)}get size(){return i.IH.sum((0,i.Vw)(this.map.values()).map(e=>e.length))}clear(){this.map.clear()}delete(e,t){if(void 0===t)return this.map.delete(e);{let r=this.map.get(e);if(r){let i=r.indexOf(t);if(i>=0)return 1===r.length?this.map.delete(e):r.splice(i,1),!0}return!1}}get(e){var t;return null!==(t=this.map.get(e))&&void 0!==t?t:[]}has(e,t){if(void 0===t)return this.map.has(e);{let r=this.map.get(e);return!!r&&r.indexOf(t)>=0}}add(e,t){return this.map.has(e)?this.map.get(e).push(t):this.map.set(e,[t]),this}addAll(e,t){return this.map.has(e)?this.map.get(e).push(...t):this.map.set(e,Array.from(t)),this}forEach(e){this.map.forEach((t,r)=>t.forEach(t=>e(t,r,this)))}[Symbol.iterator](){return this.entries().iterator()}entries(){return(0,i.Vw)(this.map.entries()).flatMap(([e,t])=>t.map(t=>[e,t]))}keys(){return(0,i.Vw)(this.map.keys())}values(){return(0,i.Vw)(this.map.values()).flat()}entriesGroupedByKey(){return(0,i.Vw)(this.map.entries())}}class a{get size(){return this.map.size}constructor(e){if(this.map=new Map,this.inverse=new Map,e)for(let[t,r]of e)this.set(t,r)}clear(){this.map.clear(),this.inverse.clear()}set(e,t){return this.map.set(e,t),this.inverse.set(t,e),this}get(e){return this.map.get(e)}getKey(e){return this.inverse.get(e)}delete(e){let t=this.map.get(e);return void 0!==t&&(this.map.delete(e),this.inverse.delete(t),!0)}}},75314:function(e,t,r){r.d(t,{LK:()=>f,OB:()=>l,Z2:()=>d,_t:()=>o,sp:()=>u,uz:()=>h,yn:()=>c});var i,n,a=r(2086),s=r(47895);function o(e){return new s.i8(e,e=>(0,a.al)(e)?e.content:[],{includeRoot:!0})}function l(e,t){for(;e.container;)if((e=e.container)===t)return!0;return!1}function u(e){return{start:{character:e.startColumn-1,line:e.startLine-1},end:{character:e.endColumn,line:e.endLine-1}}}function c(e){if(!e)return;let{offset:t,end:r,range:i}=e;return{range:i,offset:t,end:r,length:r-t}}function d(e,t){return function(e,t){if(e.end.line<t.start.line||e.end.line===t.start.line&&e.end.character<e.start.character)return n.Before;if(e.start.line>t.end.line||e.start.line===t.end.line&&e.start.character>t.end.character)return n.After;let r=e.start.line>t.start.line||e.start.line===t.start.line&&e.start.character>=t.start.character,i=e.end.line<t.end.line||e.end.line===t.end.line&&e.end.character<=t.end.character;return r&&i?n.Inside:r?n.OverlapBack:n.OverlapFront}(e,t)>n.After}(i=n||(n={}))[i.Before=0]="Before",i[i.After=1]="After",i[i.OverlapFront=2]="OverlapFront",i[i.OverlapBack=3]="OverlapBack",i[i.Inside=4]="Inside";let h=/^[\w\p{L}]$/u;function f(e,t){if(e){let r=function(e,t=!0){for(;e.container;){let r=e.container,i=r.content.indexOf(e);for(;i>0;){i--;let e=r.content[i];if(t||!e.hidden)return e}e=r}}(e,!0);if(r&&p(r,t))return r;if((0,a.U8)(e)){let r=e.content.findIndex(e=>!e.hidden);for(let i=r-1;i>=0;i--){let r=e.content[i];if(p(r,t))return r}}}}function p(e,t){return(0,a.dm)(e)&&t.includes(e.tokenType.name)}},40870:function(e,t,r){var i;r.d(t,{J:()=>i}),(i||(i={})).create=function(e){return{dispose:async()=>await e()}}},34455:function(e,t,r){r.d(t,{U:()=>n,h:()=>i});class i extends Error{constructor(e,t){super(e?`${t} at ${e.range.start.line}:${e.range.start.character}`:t)}}function n(e){throw Error("Error! The input value was not handled.")}},53289:function(e,t,r){r.d(t,{Q5:()=>i.Emitter});var i=r(27135)},46577:function(e,t,r){r.d(t,{EL:()=>h,UP:()=>y,VD:()=>u,eN:()=>c,h7:()=>m,ib:()=>v,lA:()=>g,mJ:()=>w,md:()=>d,s1:()=>S,vb:()=>f,z$:()=>function e(t){var r,i,a;if(n.F9(t))return y(t)?t.name:null!==(r=x(t))&&void 0!==r?r:t.name;if(n.QV(t)||n.P9(t)||n.Mp(t))return t.name;if(n.LG(t)){let r=(i=t).inferredType?i.inferredType.name:(null===(a=i.type)||void 0===a?void 0:a.ref)?e(i.type.ref):void 0;if(r)return r}else if(n.S_(t))return t.name;throw Error("Cannot get name of Unknown Type")}});var i=r(34455),n=r(64657),a=r(2086),s=r(23144),o=r(75314),l=r(79756);function u(e,t){let r=new Set,i=e.rules.find(e=>n.F9(e)&&e.entry);if(!i)return new Set(e.rules);for(let a of[i].concat(e.rules.filter(e=>n.MS(e)&&e.hidden)))!function e(t,r,i){r.add(t.name),(0,s.VY)(t).forEach(t=>{if(n.t3(t)||i&&n.gf(t)){let n=t.rule.ref;n&&!r.has(n.name)&&e(n,r,i)}})}(a,r,t);let a=new Set;for(let t of e.rules)(r.has(t.name)||n.MS(t)&&t.hidden)&&a.add(t);return a}function c(e){if(e.terminal)return e.terminal;if(e.type.ref){let t=v(e.type.ref);return null==t?void 0:t.terminal}}function d(e){return e.hidden&&!S(e).test(" ")}function h(e,t){return e&&t?p(e,t,e.astNode,!0):[]}function f(e,t,r){if(!e||!t)return;let i=p(e,t,e.astNode,!0);if(0!==i.length)return r=void 0!==r?Math.max(0,Math.min(r,i.length-1)):0,i[r]}function p(e,t,r,i){if(!i){let r=(0,s.V_)(e.grammarSource,n.B7);if(r&&r.feature===t)return[e]}return(0,a.al)(e)&&e.astNode===r?e.content.flatMap(e=>p(e,t,r,!1)):[]}function g(e,t,r){if(!e)return;let i=function(e,t,r){let i;if(e.astNode!==r)return[];if(n.p1(e.grammarSource)&&e.grammarSource.value===t)return[e];let a=(0,o._t)(e).iterator(),s=[];do if(!(i=a.next()).done){let e=i.value;e.astNode===r?n.p1(e.grammarSource)&&e.grammarSource.value===t&&s.push(e):a.prune()}while(!i.done);return s}(e,t,null==e?void 0:e.astNode);if(0!==i.length)return r=void 0!==r?Math.max(0,Math.min(r,i.length-1)):0,i[r]}function m(e){var t;let r=e.astNode;for(;r===(null===(t=e.container)||void 0===t?void 0:t.astNode);){let t=(0,s.V_)(e.grammarSource,n.B7);if(t)return t;e=e.container}}function v(e){let t=e;return n.S_(t)&&(n.LG(t.$container)?t=t.$container.$container:n.F9(t.$container)?t=t.$container:(0,i.U)(t.$container)),function e(t,r,i){var a;function o(r,a){let o;return(0,s.V_)(r,n.B7)||(o=e(a,a,i)),i.set(t,o),o}if(i.has(t))return i.get(t);for(let e of(i.set(t,void 0),(0,s.VY)(r))){if(n.B7(e)&&"name"===e.feature.toLowerCase())return i.set(t,e),e;if(n.t3(e)&&n.F9(e.rule.ref))return o(e,e.rule.ref);if(n.Iy(e)&&(null===(a=e.typeRef)||void 0===a?void 0:a.ref))return o(e,e.typeRef.ref)}}(e,t,new Map)}function y(e){return function e(t,r){if(r.has(t))return!0;for(let i of(r.add(t),(0,s.VY)(t)))if(n.t3(i)){if(!i.rule.ref||n.F9(i.rule.ref)&&!e(i.rule.ref,r))return!1}else if(n.B7(i))return!1;else if(n.LG(i))return!1;return!!t.definition}(e,new Set)}function x(e){if(e.inferredType)return e.inferredType.name;if(e.dataType)return e.dataType;if(e.returnType){let t=e.returnType.ref;if(t&&(n.F9(t)||n.QV(t)||n.P9(t)))return t.name}}function w(e){var t,r,i;return n.MS(e)?null!==(r=null===(t=e.type)||void 0===t?void 0:t.name)&&void 0!==r?r:"string":y(e)?e.name:null!==(i=x(e))&&void 0!==i?i:e.name}function S(e){let t={s:!1,i:!1,u:!1};return new RegExp(function e(t,r){var i,a,s,o,l;if(n.V7(t)){return D((i=t).elements.map(t=>e(t)).join("|"),{cardinality:i.cardinality,lookahead:i.lookahead})}if(n.X9(t)){return D((a=t).elements.map(t=>e(t)).join(""),{cardinality:a.cardinality,lookahead:a.lookahead})}if(n.Bf(t)){return(s=t).right?D(`[${b(s.left)}-${b(s.right)}]`,{cardinality:s.cardinality,lookahead:s.lookahead,wrap:!1}):D(b(s.left),{cardinality:s.cardinality,lookahead:s.lookahead,wrap:!1})}if(n.gf(t)){let r=t.rule.ref;if(!r)throw Error("Missing rule reference.");return D(e(r.definition),{cardinality:t.cardinality,lookahead:t.lookahead})}if(n.Bi(t)){return o=t,D(`(?!${e(o.terminal)})${k}*?`,{cardinality:o.cardinality,lookahead:o.lookahead})}else if(n.OG(t)){return l=t,D(`${k}*?${e(l.terminal)}`,{cardinality:l.cardinality,lookahead:l.lookahead})}else if(n.Sg(t)){let e=t.regex.lastIndexOf("/"),i=t.regex.substring(1,e),n=t.regex.substring(e+1);return r&&(r.i=n.includes("i"),r.s=n.includes("s"),r.u=n.includes("u")),D(i,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}else if(n.qm(t))return D(k,{cardinality:t.cardinality,lookahead:t.lookahead});else throw Error(`Invalid terminal element: ${null==t?void 0:t.$type}`)}(e.definition,t),Object.entries(t).filter(([,e])=>e).map(([e])=>e).join(""))}let k=/[\s\S]/.source;function b(e){return(0,l.hr)(e.value)}function D(e,t){var r;return((!1!==t.wrap||t.lookahead)&&(e=`(${null!==(r=t.lookahead)&&void 0!==r?r:""}${e})`),t.cardinality)?`${e}${t.cardinality}`:e}},99551:function(e,t,r){r.d(t,{sC:()=>c}),r(85016),r(53289),r(98119),r(40870),r(34455);var i=r(41125),n=r(9638),a=r(64657),s=r(98420),o=r(23303);let l={Grammar:()=>void 0,LanguageMetaData:()=>({caseInsensitive:!1,fileExtensions:[".langium"],languageId:"langium"})},u={AstReflection:()=>new a.SV};function c(e){var t;let r=function(){let e=(0,n.f3)((0,i.T)(s.u),u),t=(0,n.f3)((0,i.Q)({shared:e}),l);return e.ServiceRegistry.register(t),t}(),a=r.serializer.JsonSerializer.deserialize(e);return r.shared.workspace.LangiumDocumentFactory.fromModel(a,o.o.parse(`memory://${null!==(t=a.name)&&void 0!==t?t:"grammar"}.langium`)),a}r(331),r(47895),r(23144),r(30466),r(75314),r(46577),r(79756)},331:function(e,t,r){r.d(t,{BH:()=>l,Vl:()=>a,Xi:()=>s,qT:()=>o});var i=r(30466);let n=0,a=Symbol("OperationCancelled");function s(e){return e===a}async function o(e){if(e===i.Ts.None)return;let t=Date.now();if(t-n>=10&&(n=t,await new Promise(e=>{"undefined"==typeof setImmediate?setTimeout(e,0):setImmediate(e)})),e.isCancellationRequested)throw a}class l{constructor(){this.promise=new Promise((e,t)=>{this.resolve=t=>(e(t),this),this.reject=e=>(t(e),this)})}}},79756:function(e,t,r){r.d(t,{K0:()=>n,Rn:()=>l,XC:()=>h,cb:()=>u,cp:()=>d,hr:()=>c});var i=r(55832);let n=/\r?\n/gm,a=new i.O;class s extends i.e{constructor(){super(...arguments),this.isStarting=!0,this.endRegexpStack=[],this.multiline=!1}get endRegex(){return this.endRegexpStack.join("")}reset(e){this.multiline=!1,this.regex=e,this.startRegexp="",this.isStarting=!0,this.endRegexpStack=[]}visitGroup(e){e.quantifier&&(this.isStarting=!1,this.endRegexpStack=[])}visitCharacter(e){let t=String.fromCharCode(e.value);if(this.multiline||"\n"!==t||(this.multiline=!0),e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{let e=c(t);this.endRegexpStack.push(e),this.isStarting&&(this.startRegexp+=e)}}visitSet(e){if(!this.multiline){let t=new RegExp(this.regex.substring(e.loc.begin,e.loc.end));this.multiline=!!"\n".match(t)}if(e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{let t=this.regex.substring(e.loc.begin,e.loc.end);this.endRegexpStack.push(t),this.isStarting&&(this.startRegexp+=t)}}visitChildren(e){("Group"!==e.type||!e.quantifier)&&super.visitChildren(e)}}let o=new s;function l(e){try{return"string"==typeof e&&(e=new RegExp(e)),e=e.toString(),o.reset(e),o.visit(a.pattern(e)),o.multiline}catch(e){return!1}}function u(e){return("string"==typeof e?new RegExp(e):e).test(" ")}function c(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(e){return Array.prototype.map.call(e,e=>/\w/.test(e)?`[${e.toLowerCase()}${e.toUpperCase()}]`:c(e)).join("")}function h(e,t){let r=function(e){"string"==typeof e&&(e=new RegExp(e));let t=e,r=e.source,i=0;return new RegExp(function e(){let n="",a;function s(e){n+=r.substr(i,e),i+=e}function o(e){n+="(?:"+r.substr(i,e)+"|$)",i+=e}for(;i<r.length;)switch(r[i]){case"\\":switch(r[i+1]){case"c":o(3);break;case"x":o(4);break;case"u":o(t.unicode?"{"===r[i+2]?r.indexOf("}",i)-i+1:6:2);break;case"p":case"P":o(t.unicode?r.indexOf("}",i)-i+1:2);break;case"k":o(r.indexOf(">",i)-i+1);break;default:o(2)}break;case"[":(a=/\[(?:\\.|.)*?\]/g).lastIndex=i,o((a=a.exec(r)||[])[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":s(1);break;case"{":(a=/\{\d+,?\d*\}/g).lastIndex=i,(a=a.exec(r))?s(a[0].length):o(1);break;case"(":if("?"===r[i+1])switch(r[i+2]){case":":n+="(?:",i+=3,n+=e()+"|$)";break;case"=":n+="(?=",i+=3,n+=e()+")";break;case"!":a=i,i+=3,e(),n+=r.substr(a,i-a);break;case"<":switch(r[i+3]){case"=":case"!":a=i,i+=4,e(),n+=r.substr(a,i-a);break;default:s(r.indexOf(">",i)-i+1),n+=e()+"|$)"}}else s(1),n+=e()+"|$)";break;case")":return++i,n;default:o(1)}return n}(),e.flags)}(e),i=t.match(r);return!!i&&i[0].length>0}},47895:function(e,t,r){var i,n;r.d(t,{IH:()=>i,Ry:()=>l,Vw:()=>u,i:()=>a,i8:()=>c});class a{constructor(e,t){this.startFn=e,this.nextFn=t}iterator(){let e={state:this.startFn(),next:()=>this.nextFn(e.state),[Symbol.iterator]:()=>e};return e}[Symbol.iterator](){return this.iterator()}isEmpty(){return!!this.iterator().next().done}count(){let e=this.iterator(),t=0,r=e.next();for(;!r.done;)t++,r=e.next();return t}toArray(){let e;let t=[],r=this.iterator();do void 0!==(e=r.next()).value&&t.push(e.value);while(!e.done);return t}toSet(){return new Set(this)}toMap(e,t){return new Map(this.map(r=>[e?e(r):r,t?t(r):r]))}toString(){return this.join()}concat(e){let t=e[Symbol.iterator]();return new a(()=>({first:this.startFn(),firstDone:!1}),e=>{let r;if(!e.firstDone){do if(!(r=this.nextFn(e.first)).done)return r;while(!r.done);e.firstDone=!0}do if(!(r=t.next()).done)return r;while(!r.done);return l})}join(e=","){let t;let r=this.iterator(),i="",n=!1;do{var a;(t=r.next()).done||(n&&(i+=e),i+="string"==typeof(a=t.value)?a:void 0===a?"undefined":"function"==typeof a.toString?a.toString():Object.prototype.toString.call(a)),n=!0}while(!t.done);return i}indexOf(e,t=0){let r=this.iterator(),i=0,n=r.next();for(;!n.done;){if(i>=t&&n.value===e)return i;n=r.next(),i++}return -1}every(e){let t=this.iterator(),r=t.next();for(;!r.done;){if(!e(r.value))return!1;r=t.next()}return!0}some(e){let t=this.iterator(),r=t.next();for(;!r.done;){if(e(r.value))return!0;r=t.next()}return!1}forEach(e){let t=this.iterator(),r=0,i=t.next();for(;!i.done;)e(i.value,r),i=t.next(),r++}map(e){return new a(this.startFn,t=>{let{done:r,value:i}=this.nextFn(t);return r?l:{done:!1,value:e(i)}})}filter(e){return new a(this.startFn,t=>{let r;do if(!(r=this.nextFn(t)).done&&e(r.value))return r;while(!r.done);return l})}nonNullable(){return this.filter(e=>null!=e)}reduce(e,t){let r=this.iterator(),i=t,n=r.next();for(;!n.done;)i=void 0===i?n.value:e(i,n.value),n=r.next();return i}reduceRight(e,t){return this.recursiveReduce(this.iterator(),e,t)}recursiveReduce(e,t,r){let i=e.next();if(i.done)return r;let n=this.recursiveReduce(e,t,r);return void 0===n?i.value:t(n,i.value)}find(e){let t=this.iterator(),r=t.next();for(;!r.done;){if(e(r.value))return r.value;r=t.next()}}findIndex(e){let t=this.iterator(),r=0,i=t.next();for(;!i.done;){if(e(i.value))return r;i=t.next(),r++}return -1}includes(e){let t=this.iterator(),r=t.next();for(;!r.done;){if(r.value===e)return!0;r=t.next()}return!1}flatMap(e){return new a(()=>({this:this.startFn()}),t=>{do{if(t.iterator){let e=t.iterator.next();if(!e.done)return e;t.iterator=void 0}let{done:r,value:i}=this.nextFn(t.this);if(!r){let r=e(i);if(!s(r))return{done:!1,value:r};t.iterator=r[Symbol.iterator]()}}while(t.iterator);return l})}flat(e){if(void 0===e&&(e=1),e<=0)return this;let t=e>1?this.flat(e-1):this;return new a(()=>({this:t.startFn()}),e=>{do{if(e.iterator){let t=e.iterator.next();if(!t.done)return t;e.iterator=void 0}let{done:r,value:i}=t.nextFn(e.this);if(!r){if(!s(i))return{done:!1,value:i};e.iterator=i[Symbol.iterator]()}}while(e.iterator);return l})}head(){let e=this.iterator().next();if(!e.done)return e.value}tail(e=1){return new a(()=>{let t=this.startFn();for(let r=0;r<e&&!this.nextFn(t).done;r++);return t},this.nextFn)}limit(e){return new a(()=>({size:0,state:this.startFn()}),t=>(t.size++,t.size>e)?l:this.nextFn(t.state))}distinct(e){let t=new Set;return this.filter(r=>{let i=e?e(r):r;return!t.has(i)&&(t.add(i),!0)})}exclude(e,t){let r=new Set;for(let i of e){let e=t?t(i):i;r.add(e)}return this.filter(e=>{let i=t?t(e):e;return!r.has(i)})}}function s(e){return!!e&&"function"==typeof e[Symbol.iterator]}let o=new a(()=>void 0,()=>l),l=Object.freeze({done:!0,value:void 0});function u(...e){if(1===e.length){let t=e[0];if(t instanceof a)return t;if(s(t))return new a(()=>t[Symbol.iterator](),e=>e.next());if("number"==typeof t.length)return new a(()=>({index:0}),e=>e.index<t.length?{done:!1,value:t[e.index++]}:l)}return e.length>1?new a(()=>({collIndex:0,arrIndex:0}),t=>{do{if(t.iterator){let e=t.iterator.next();if(!e.done)return e;t.iterator=void 0}if(t.array){if(t.arrIndex<t.array.length)return{done:!1,value:t.array[t.arrIndex++]};t.array=void 0,t.arrIndex=0}if(t.collIndex<e.length){let r=e[t.collIndex++];s(r)?t.iterator=r[Symbol.iterator]():r&&"number"==typeof r.length&&(t.array=r)}}while(t.iterator||t.array||t.collIndex<e.length);return l}):o}class c extends a{constructor(e,t,r){super(()=>({iterators:(null==r?void 0:r.includeRoot)?[[e][Symbol.iterator]()]:[t(e)[Symbol.iterator]()],pruned:!1}),e=>{for(e.pruned&&(e.iterators.pop(),e.pruned=!1);e.iterators.length>0;){let r=e.iterators[e.iterators.length-1].next();if(!r.done)return e.iterators.push(t(r.value)[Symbol.iterator]()),r;e.iterators.pop()}return l})}iterator(){let e={state:this.startFn(),next:()=>this.nextFn(e.state),prune:()=>{e.state.pruned=!0},[Symbol.iterator]:()=>e};return e}}(n=i||(i={})).sum=function(e){return e.reduce((e,t)=>e+t,0)},n.product=function(e){return e.reduce((e,t)=>e*t,0)},n.min=function(e){return e.reduce((e,t)=>Math.min(e,t))},n.max=function(e){return e.reduce((e,t)=>Math.max(e,t))}},23303:function(e,t,r){r.d(t,{o:()=>a.o,x:()=>n});var i,n,a=r(36621);(i=n||(n={})).basename=a.c.basename,i.dirname=a.c.dirname,i.extname=a.c.extname,i.joinPath=a.c.joinPath,i.resolvePath=a.c.resolvePath,i.equals=function(e,t){return(null==e?void 0:e.toString())===(null==t?void 0:t.toString())},i.relative=function(e,t){let r="string"==typeof e?e:e.path,i="string"==typeof t?t:t.path,n=r.split("/").filter(e=>e.length>0),a=i.split("/").filter(e=>e.length>0),s=0;for(;s<n.length&&n[s]===a[s];s++);return"../".repeat(n.length-s)+a.slice(s).join("/")}},14951:function(e,t,r){r.d(t,{Yj:()=>d});var i,n,a=r(30466),s=r(46577),o=r(23144),l=r(75314),u=r(331),c=r(98208);class d{constructor(e){this.validationRegistry=e.validation.ValidationRegistry,this.metadata=e.LanguageMetaData}async validateDocument(e,t={},r=a.Ts.None){let i=e.parseResult,s=[];if(await (0,u.qT)(r),(!t.categories||t.categories.includes("built-in"))&&(this.processLexingErrors(i,s,t),t.stopAfterLexingErrors&&s.some(e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.code)===n.LexingError})||(this.processParsingErrors(i,s,t),t.stopAfterParsingErrors&&s.some(e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.code)===n.ParsingError}))||(this.processLinkingErrors(e,s,t),t.stopAfterLinkingErrors&&s.some(e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.code)===n.LinkingError}))))return s;try{s.push(...await this.validateAst(i.value,t,r))}catch(e){if((0,u.Xi)(e))throw e;console.error("An error occurred during validation:",e)}return await (0,u.qT)(r),s}processLexingErrors(e,t,r){for(let r of e.lexerErrors){let e={severity:h("error"),range:{start:{line:r.line-1,character:r.column-1},end:{line:r.line-1,character:r.column+r.length-1}},message:r.message,data:(0,c.kS)(n.LexingError),source:this.getSource()};t.push(e)}}processParsingErrors(e,t,r){for(let r of e.parserErrors){let e;if(isNaN(r.token.startOffset)){if("previousToken"in r){let t=r.previousToken;if(isNaN(t.startOffset)){let t={line:0,character:0};e={start:t,end:t}}else{let r={line:t.endLine-1,character:t.endColumn};e={start:r,end:r}}}}else e=(0,l.sp)(r.token);if(e){let i={severity:h("error"),range:e,message:r.message,data:(0,c.kS)(n.ParsingError),source:this.getSource()};t.push(i)}}}processLinkingErrors(e,t,r){for(let r of e.references){let e=r.error;if(e){let r={node:e.container,property:e.property,index:e.index,data:{code:n.LinkingError,containerType:e.container.$type,property:e.property,refText:e.reference.$refText}};t.push(this.toDiagnostic("error",e.message,r))}}}async validateAst(e,t,r=a.Ts.None){let i=[],n=(e,t,r)=>{i.push(this.toDiagnostic(e,t,r))};return await Promise.all((0,o.Zc)(e).map(async e=>{for(let i of(await (0,u.qT)(r),this.validationRegistry.getChecks(e.$type,t.categories)))await i(e,n,r)})),i}toDiagnostic(e,t,r){var i;let n;return{message:t,range:(i=r).range?i.range:("string"==typeof i.property?n=(0,s.vb)(i.node.$cstNode,i.property,i.index):"string"==typeof i.keyword&&(n=(0,s.lA)(i.node.$cstNode,i.keyword,i.index)),null!=n||(n=i.node.$cstNode),n)?n.range:{start:{line:0,character:0},end:{line:0,character:0}},severity:h(e),code:r.code,codeDescription:r.codeDescription,tags:r.tags,relatedInformation:r.relatedInformation,data:r.data,source:this.getSource()}}getSource(){return this.metadata.languageId}}function h(e){switch(e){case"error":return 1;case"warning":return 2;case"info":return 3;case"hint":return 4;default:throw Error("Invalid diagnostic severity: "+e)}}(i=n||(n={})).LexingError="lexing-error",i.ParsingError="parsing-error",i.LinkingError="linking-error"},66801:function(e,t,r){r(14951),r(98208)},98208:function(e,t,r){r.d(t,{E1:()=>l,T3:()=>i,kS:()=>o});var i,n=r(98119),a=r(331),s=r(47895);function o(e){return{code:e}}(i||(i={})).all=["fast","slow","built-in"];class l{constructor(e){this.entries=new n.k,this.reflection=e.shared.AstReflection}register(e,t=this,r="fast"){if("built-in"===r)throw Error("The 'built-in' category is reserved for lexer, parser, and linker errors.");for(let[i,n]of Object.entries(e))if(Array.isArray(n))for(let e of n){let n={check:this.wrapValidationException(e,t),category:r};this.addEntry(i,n)}else if("function"==typeof n){let e={check:this.wrapValidationException(n,t),category:r};this.addEntry(i,e)}}wrapValidationException(e,t){return async(r,i,n)=>{try{await e.call(t,r,i,n)}catch(t){if((0,a.Xi)(t))throw t;console.error("An error occurred during validation:",t);let e=t instanceof Error?t.message:String(t);t instanceof Error&&t.stack&&console.error(t.stack),i("error","An error occurred during validation: "+e,{node:r})}}}addEntry(e,t){if("AstNode"===e){this.entries.add("AstNode",t);return}for(let r of this.reflection.getAllSubTypes(e))this.entries.add(r,t)}getChecks(e,t){let r=(0,s.Vw)(this.entries.get(e)).concat(this.entries.get("AstNode"));return t&&(r=r.filter(e=>t.includes(e.category))),r.map(e=>e.check)}}},11295:function(e,t,r){r.d(t,{H:()=>c,V:()=>u});var i=r(30466),n=r(2086),a=r(23144),s=r(75314),o=r(331),l=r(23303);class u{constructor(e){this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider}createDescription(e,t,r=(0,a.Me)(e)){let i;null!=t||(t=this.nameProvider.getName(e));let n=this.astNodeLocator.getAstNodePath(e);if(!t)throw Error(`Node at path ${n} has no name.`);let o=()=>{var t;return null!=i?i:i=(0,s.yn)(null!==(t=this.nameProvider.getNameNode(e))&&void 0!==t?t:e.$cstNode)};return{node:e,name:t,get nameSegment(){return o()},selectionSegment:(0,s.yn)(e.$cstNode),type:e.$type,documentUri:r.uri,path:n}}}class c{constructor(e){this.nodeLocator=e.workspace.AstNodeLocator}async createDescriptions(e,t=i.Ts.None){let r=[],s=e.parseResult.value;for(let e of(0,a.Zc)(s))await (0,o.qT)(t),(0,a.fy)(e).filter(e=>!(0,n.et)(e)).forEach(e=>{let t=this.createDescription(e);t&&r.push(t)});return r}createDescription(e){let t=e.reference.$nodeDescription,r=e.reference.$refNode;if(!t||!r)return;let i=(0,a.Me)(e.container).uri;return{sourceUri:i,sourcePath:this.nodeLocator.getAstNodePath(e.container),targetUri:t.documentUri,targetPath:t.path,segment:(0,s.yn)(r),local:l.x.equals(t.documentUri,i)}}}},7018:function(e,t,r){r.d(t,{i:()=>i});class i{constructor(){this.segmentSeparator="/",this.indexSeparator="@"}getAstNodePath(e){if(e.$container){let t=this.getAstNodePath(e.$container),r=this.getPathSegment(e);return t+this.segmentSeparator+r}return""}getPathSegment({$containerProperty:e,$containerIndex:t}){if(!e)throw Error("Missing '$containerProperty' in AST node.");return void 0!==t?e+this.indexSeparator+t:e}getAstNode(e,t){return t.split(this.segmentSeparator).reduce((e,t)=>{if(!e||0===t.length)return e;let r=t.indexOf(this.indexSeparator);if(r>0){let i=t.substring(0,r),n=parseInt(t.substring(r+1)),a=e[i];return null==a?void 0:a[n]}return e[t]},e)}}},75456:function(e,t,r){r.d(t,{G:()=>n});var i=r(331);class n{constructor(e){this._ready=new i.BH,this.settings={},this.workspaceConfig=!1,this.serviceRegistry=e.ServiceRegistry}get ready(){return this._ready.promise}initialize(e){var t,r;this.workspaceConfig=null!==(r=null===(t=e.capabilities.workspace)||void 0===t?void 0:t.configuration)&&void 0!==r&&r}async initialized(e){if(this.workspaceConfig){if(e.register){let t=this.serviceRegistry.all;e.register({section:t.map(e=>this.toSectionName(e.LanguageMetaData.languageId))})}if(e.fetchConfiguration){let t=this.serviceRegistry.all.map(e=>({section:this.toSectionName(e.LanguageMetaData.languageId)})),r=await e.fetchConfiguration(t);t.forEach((e,t)=>{this.updateSectionConfiguration(e.section,r[t])})}}this._ready.resolve()}updateConfiguration(e){e.settings&&Object.keys(e.settings).forEach(t=>{this.updateSectionConfiguration(t,e.settings[t])})}updateSectionConfiguration(e,t){this.settings[e]=t}async getConfiguration(e,t){await this.ready;let r=this.toSectionName(e);if(this.settings[r])return this.settings[r][t]}toSectionName(e){return`${e}`}}},45888:function(e,t,r){r.d(t,{A:()=>c});var i=r(30466),n=r(40870),a=r(98119),s=r(331),o=r(47895),l=r(98208),u=r(81745);class c{constructor(e){this.updateBuildOptions={validation:{categories:["built-in","fast"]}},this.updateListeners=[],this.buildPhaseListeners=new a.k,this.buildState=new Map,this.documentBuildWaiters=new Map,this.currentState=u.z.Changed,this.langiumDocuments=e.workspace.LangiumDocuments,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.indexManager=e.workspace.IndexManager,this.serviceRegistry=e.ServiceRegistry}async build(e,t={},r=i.Ts.None){var n,a;for(let r of e){let e=r.uri.toString();if(r.state===u.z.Validated){if("boolean"==typeof t.validation&&t.validation)r.state=u.z.IndexedReferences,r.diagnostics=void 0,this.buildState.delete(e);else if("object"==typeof t.validation){let i=this.buildState.get(e),s=null===(n=null==i?void 0:i.result)||void 0===n?void 0:n.validationChecks;if(s){let n=(null!==(a=t.validation.categories)&&void 0!==a?a:l.T3.all).filter(e=>!s.includes(e));n.length>0&&(this.buildState.set(e,{completed:!1,options:{validation:Object.assign(Object.assign({},t.validation),{categories:n})},result:i.result}),r.state=u.z.IndexedReferences)}}}else this.buildState.delete(e)}this.currentState=u.z.Changed,await this.emitUpdate(e.map(e=>e.uri),[]),await this.buildDocuments(e,t,r)}async update(e,t,r=i.Ts.None){for(let e of(this.currentState=u.z.Changed,t))this.langiumDocuments.deleteDocument(e),this.buildState.delete(e.toString()),this.indexManager.remove(e);for(let t of e){if(!this.langiumDocuments.invalidateDocument(t)){let e=this.langiumDocumentFactory.fromModel({$type:"INVALID"},t);e.state=u.z.Changed,this.langiumDocuments.addDocument(e)}this.buildState.delete(t.toString())}let n=(0,o.Vw)(e).concat(t).map(e=>e.toString()).toSet();this.langiumDocuments.all.filter(e=>!n.has(e.uri.toString())&&this.shouldRelink(e,n)).forEach(e=>{this.serviceRegistry.getServices(e.uri).references.Linker.unlink(e),e.state=Math.min(e.state,u.z.ComputedScopes),e.diagnostics=void 0}),await this.emitUpdate(e,t),await (0,s.qT)(r);let a=this.langiumDocuments.all.filter(e=>{var t;return e.state<u.z.Linked||!(null===(t=this.buildState.get(e.uri.toString()))||void 0===t?void 0:t.completed)}).toArray();await this.buildDocuments(a,this.updateBuildOptions,r)}async emitUpdate(e,t){await Promise.all(this.updateListeners.map(r=>r(e,t)))}shouldRelink(e,t){return!!e.references.some(e=>void 0!==e.error)||this.indexManager.isAffected(e,t)}onUpdate(e){return this.updateListeners.push(e),n.J.create(()=>{let t=this.updateListeners.indexOf(e);t>=0&&this.updateListeners.splice(t,1)})}async buildDocuments(e,t,r){this.prepareBuild(e,t),await this.runCancelable(e,u.z.Parsed,r,e=>this.langiumDocumentFactory.update(e,r)),await this.runCancelable(e,u.z.IndexedContent,r,e=>this.indexManager.updateContent(e,r)),await this.runCancelable(e,u.z.ComputedScopes,r,async e=>{let t=this.serviceRegistry.getServices(e.uri).references.ScopeComputation;e.precomputedScopes=await t.computeLocalScopes(e,r)}),await this.runCancelable(e,u.z.Linked,r,e=>this.serviceRegistry.getServices(e.uri).references.Linker.link(e,r)),await this.runCancelable(e,u.z.IndexedReferences,r,e=>this.indexManager.updateReferences(e,r));let i=e.filter(e=>this.shouldValidate(e));for(let t of(await this.runCancelable(i,u.z.Validated,r,e=>this.validate(e,r)),e)){let e=this.buildState.get(t.uri.toString());e&&(e.completed=!0)}}prepareBuild(e,t){for(let r of e){let e=r.uri.toString(),i=this.buildState.get(e);(!i||i.completed)&&this.buildState.set(e,{completed:!1,options:t,result:null==i?void 0:i.result})}}async runCancelable(e,t,r,i){let n=e.filter(e=>e.state<t);for(let e of n)await (0,s.qT)(r),await i(e),e.state=t;await this.notifyBuildPhase(n,t,r),this.currentState=t}onBuildPhase(e,t){return this.buildPhaseListeners.add(e,t),n.J.create(()=>{this.buildPhaseListeners.delete(e,t)})}waitUntil(e,t,r){let n;if(t&&"path"in t?n=t:r=t,null!=r||(r=i.Ts.None),n){let t=this.langiumDocuments.getDocument(n);if(t&&t.state>e)return Promise.resolve(n)}return this.currentState>=e?Promise.resolve(void 0):r.isCancellationRequested?Promise.reject(s.Vl):new Promise((t,i)=>{let a=this.onBuildPhase(e,()=>{if(a.dispose(),o.dispose(),n){let e=this.langiumDocuments.getDocument(n);t(null==e?void 0:e.uri)}else t(void 0)}),o=r.onCancellationRequested(()=>{a.dispose(),o.dispose(),i(s.Vl)})})}async notifyBuildPhase(e,t,r){if(0!==e.length)for(let i of this.buildPhaseListeners.get(t))await (0,s.qT)(r),await i(e,r)}shouldValidate(e){return!!this.getBuildOptions(e).validation}async validate(e,t){var r,i;let n=this.serviceRegistry.getServices(e.uri).validation.DocumentValidator,a=this.getBuildOptions(e).validation,s="object"==typeof a?a:void 0,o=await n.validateDocument(e,s,t);e.diagnostics?e.diagnostics.push(...o):e.diagnostics=o;let u=this.buildState.get(e.uri.toString());if(u){null!==(r=u.result)&&void 0!==r||(u.result={});let e=null!==(i=null==s?void 0:s.categories)&&void 0!==i?i:l.T3.all;u.result.validationChecks?u.result.validationChecks.push(...e):u.result.validationChecks=[...e]}}getBuildOptions(e){var t,r;return null!==(r=null===(t=this.buildState.get(e.uri.toString()))||void 0===t?void 0:t.options)&&void 0!==r?r:{}}}},81745:function(e,t,r){r.d(t,{kq:()=>c,nQ:()=>a.n,qI:()=>d,z:()=>n});var i,n,a=r(34104),s=r(81745),o=r(30466),l=r(47895),u=r(23303);(i=n||(n={}))[i.Changed=0]="Changed",i[i.Parsed=1]="Parsed",i[i.IndexedContent=2]="IndexedContent",i[i.ComputedScopes=3]="ComputedScopes",i[i.Linked=4]="Linked",i[i.IndexedReferences=5]="IndexedReferences",i[i.Validated=6]="Validated";class c{constructor(e){this.serviceRegistry=e.ServiceRegistry,this.textDocuments=e.workspace.TextDocuments,this.fileSystemProvider=e.workspace.FileSystemProvider}async fromUri(e,t=o.Ts.None){let r=await this.fileSystemProvider.readFile(e);return this.createAsync(e,r,t)}fromTextDocument(e,t,r){return(t=null!=t?t:u.o.parse(e.uri),r)?this.createAsync(t,e,r):this.create(t,e)}fromString(e,t,r){return r?this.createAsync(t,e,r):this.create(t,e)}fromModel(e,t){return this.create(t,{$model:e})}create(e,t){if("string"==typeof t){let r=this.parse(e,t);return this.createLangiumDocument(r,e,void 0,t)}if("$model"in t){let r={value:t.$model,parserErrors:[],lexerErrors:[]};return this.createLangiumDocument(r,e)}{let r=this.parse(e,t.getText());return this.createLangiumDocument(r,e,t)}}async createAsync(e,t,r){if("string"==typeof t){let i=await this.parseAsync(e,t,r);return this.createLangiumDocument(i,e,void 0,t)}{let i=await this.parseAsync(e,t.getText(),r);return this.createLangiumDocument(i,e,t)}}createLangiumDocument(e,t,r,i){let a;if(r)a={parseResult:e,uri:t,state:n.Parsed,references:[],textDocument:r};else{let r=this.createTextDocumentGetter(t,i);a={parseResult:e,uri:t,state:n.Parsed,references:[],get textDocument(){return r()}}}return e.value.$document=a,a}async update(e,t){var r,i;let a=null===(r=e.parseResult.value.$cstNode)||void 0===r?void 0:r.root.fullText,s=null===(i=this.textDocuments)||void 0===i?void 0:i.get(e.uri.toString()),o=s?s.getText():await this.fileSystemProvider.readFile(e.uri);if(s)Object.defineProperty(e,"textDocument",{value:s});else{let t=this.createTextDocumentGetter(e.uri,o);Object.defineProperty(e,"textDocument",{get:t})}return a!==o&&(e.parseResult=await this.parseAsync(e.uri,o,t),e.parseResult.value.$document=e),e.state=n.Parsed,e}parse(e,t){return this.serviceRegistry.getServices(e).parser.LangiumParser.parse(t)}parseAsync(e,t,r){return this.serviceRegistry.getServices(e).parser.AsyncParser.parse(t,r)}createTextDocumentGetter(e,t){let r;let i=this.serviceRegistry;return()=>null!=r?r:r=s.nQ.create(e.toString(),i.getServices(e).LanguageMetaData.languageId,0,null!=t?t:"")}}class d{constructor(e){this.documentMap=new Map,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory}get all(){return(0,l.Vw)(this.documentMap.values())}addDocument(e){let t=e.uri.toString();if(this.documentMap.has(t))throw Error(`A document with the URI '${t}' is already present.`);this.documentMap.set(t,e)}getDocument(e){let t=e.toString();return this.documentMap.get(t)}async getOrCreateDocument(e,t){let r=this.getDocument(e);return r||(r=await this.langiumDocumentFactory.fromUri(e,t),this.addDocument(r)),r}createDocument(e,t,r){if(r)return this.langiumDocumentFactory.fromString(t,e,r).then(e=>(this.addDocument(e),e));{let r=this.langiumDocumentFactory.fromString(t,e);return this.addDocument(r),r}}hasDocument(e){return this.documentMap.has(e.toString())}invalidateDocument(e){let t=e.toString(),r=this.documentMap.get(t);return r&&(r.state=n.Changed,r.precomputedScopes=void 0,r.references=[],r.diagnostics=void 0),r}deleteDocument(e){let t=e.toString(),r=this.documentMap.get(t);return r&&(r.state=n.Changed,this.documentMap.delete(t)),r}}},98420:function(e,t,r){r.d(t,{u:()=>n});class i{readFile(){throw Error("No file system is available.")}async readDirectory(){return[]}}let n={fileSystemProvider:()=>new i}},2323:function(e,t,r){r.d(t,{T:()=>l});var i=r(23144),n=r(85016),a=r(30466),s=r(47895),o=r(23303);class l{constructor(e){this.symbolIndex=new Map,this.symbolByTypeIndex=new n.ne,this.referenceIndex=new Map,this.documents=e.workspace.LangiumDocuments,this.serviceRegistry=e.ServiceRegistry,this.astReflection=e.AstReflection}findAllReferences(e,t){let r=(0,i.Me)(e).uri,n=[];return this.referenceIndex.forEach(e=>{e.forEach(e=>{o.x.equals(e.targetUri,r)&&e.targetPath===t&&n.push(e)})}),(0,s.Vw)(n)}allElements(e,t){let r=(0,s.Vw)(this.symbolIndex.keys());return t&&(r=r.filter(e=>!t||t.has(e))),r.map(t=>this.getFileDescriptions(t,e)).flat()}getFileDescriptions(e,t){var r;return t?this.symbolByTypeIndex.get(e,t,()=>{var r;return(null!==(r=this.symbolIndex.get(e))&&void 0!==r?r:[]).filter(e=>this.astReflection.isSubtype(e.type,t))}):null!==(r=this.symbolIndex.get(e))&&void 0!==r?r:[]}remove(e){let t=e.toString();this.symbolIndex.delete(t),this.symbolByTypeIndex.clear(t),this.referenceIndex.delete(t)}async updateContent(e,t=a.Ts.None){let r=this.serviceRegistry.getServices(e.uri),i=await r.references.ScopeComputation.computeExports(e,t),n=e.uri.toString();this.symbolIndex.set(n,i),this.symbolByTypeIndex.clear(n)}async updateReferences(e,t=a.Ts.None){let r=this.serviceRegistry.getServices(e.uri),i=await r.workspace.ReferenceDescriptionProvider.createDescriptions(e,t);this.referenceIndex.set(e.uri.toString(),i)}isAffected(e,t){let r=this.referenceIndex.get(e.uri.toString());return!!r&&r.some(e=>!e.local&&t.has(e.targetUri.toString()))}}},61989:function(e,t,r){r.d(t,{uZ:()=>i.u}),r(11295),r(75456),r(45888),r(81745);var i=r(98420);r(2323),r(55582),r(44151)},55582:function(e,t,r){r.d(t,{Z:()=>a});var i=r(30466),n=r(331);class a{constructor(){this.previousTokenSource=new i.AU,this.writeQueue=[],this.readQueue=[],this.done=!0}write(e){this.cancelWrite();let t=new i.AU;return this.previousTokenSource=t,this.enqueue(this.writeQueue,e,t.token)}read(e){return this.enqueue(this.readQueue,e)}enqueue(e,t,r){let a=new n.BH,s={action:t,deferred:a,cancellationToken:null!=r?r:i.Ts.None};return e.push(s),this.performNextOperation(),a.promise}async performNextOperation(){if(!this.done)return;let e=[];if(this.writeQueue.length>0)e.push(this.writeQueue.shift());else{if(!(this.readQueue.length>0))return;e.push(...this.readQueue.splice(0,this.readQueue.length))}this.done=!1,await Promise.all(e.map(async({action:e,deferred:t,cancellationToken:r})=>{try{let i=await Promise.resolve().then(()=>e(r));t.resolve(i)}catch(e){(0,n.Xi)(e)?t.resolve(void 0):t.reject(e)}})),this.done=!0,this.performNextOperation()}cancelWrite(){this.previousTokenSource.cancel()}}},44151:function(e,t,r){r.d(t,{t:()=>s});var i=r(30466),n=r(331),a=r(23303);class s{constructor(e){this.initialBuildOptions={},this._ready=new n.BH,this.serviceRegistry=e.ServiceRegistry,this.langiumDocuments=e.workspace.LangiumDocuments,this.documentBuilder=e.workspace.DocumentBuilder,this.fileSystemProvider=e.workspace.FileSystemProvider,this.mutex=e.workspace.WorkspaceLock}get ready(){return this._ready.promise}initialize(e){var t;this.folders=null!==(t=e.workspaceFolders)&&void 0!==t?t:void 0}initialized(e){return this.mutex.write(e=>{var t;return this.initializeWorkspace(null!==(t=this.folders)&&void 0!==t?t:[],e)})}async initializeWorkspace(e,t=i.Ts.None){let r=await this.performStartup(e);await (0,n.qT)(t),await this.documentBuilder.build(r,this.initialBuildOptions,t)}async performStartup(e){let t=this.serviceRegistry.all.flatMap(e=>e.LanguageMetaData.fileExtensions),r=[],i=e=>{r.push(e),this.langiumDocuments.hasDocument(e.uri)||this.langiumDocuments.addDocument(e)};return await this.loadAdditionalDocuments(e,i),await Promise.all(e.map(e=>[e,this.getRootFolder(e)]).map(async e=>this.traverseFolder(...e,t,i))),this._ready.resolve(),r}loadAdditionalDocuments(e,t){return Promise.resolve()}getRootFolder(e){return a.o.parse(e.uri)}async traverseFolder(e,t,r,i){let n=await this.fileSystemProvider.readDirectory(t);await Promise.all(n.map(async t=>{this.includeEntry(e,t,r)&&(t.isDirectory?await this.traverseFolder(e,t.uri,r,i):t.isFile&&i(await this.langiumDocuments.getOrCreateDocument(t.uri)))}))}includeEntry(e,t,r){let i=a.x.basename(t.uri);if(i.startsWith("."))return!1;if(t.isDirectory)return"node_modules"!==i&&"out"!==i;if(t.isFile){let e=a.x.extname(t.uri);return r.includes(e)}return!1}}}}]);
//# sourceMappingURL=287.d22eb566b99ecff7.js.map